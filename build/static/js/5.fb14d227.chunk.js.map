{"version":3,"sources":["pages/users/index.module.less","configs/base.config.ts","configs/dev.config.ts","configs/prod.config.ts","configs/index.ts","server/index.ts","pages/users/index.tsx"],"names":["module","exports","baseConfig","api","timeout","code","success","excludedTipCode","tip","unknown","serverError","resendVcodeInterval","devConf","url","defaultsDeep","prodConf","config","Axios","axios","create","baseURL","process","withCredentials","headers","interceptors","request","use","method","data","qs","stringify","error","Promise","reject","response","params","resolve","Object","assign","then","err","Cancel","catch","post","get","this","res","Users","state","tableData","value","loading","pagination","modalData","visible","id","age","name","type","columns","title","dataIndex","key","render","text","record","className","styles","operation","operationBtn","size","onClick","showModal","deleteUser","fetchUserList","http","setState","_this","confirm","content","onOk","props","form","setFieldsValue","hideModal","addUser","editUser","handleModalSubmit","e","preventDefault","validateFields","values","getFieldDecorator","main","bordered","dataSource","rowKey","String","onCancel","Item","rules","required","message","placeholder","Component"],"mappings":"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","file":"static/js/5.fb14d227.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"operation\":\"operation--1qqOk\",\"operationBtn\":\"operationBtn--1iM62\",\"main\":\"main--3jljR\"};","/**\n * 通用配置\n */\n\nconst statusCode = {\n  // 成功\n  success: 200\n}\n\nexport const baseConfig = {\n  // api 配置\n  api: {\n    // 网络请求超时时间\n    timeout: 6000,\n    // 状态吗定义\n    code: statusCode,\n    // 不以 toast 提示的状态码列表\n    excludedTipCode: [\n\n    ],\n    tip: {\n      unknown: '未知错误',\n      serverError: '服务器繁忙，请稍后再试',\n    }\n  },\n  // 重新发送验证码间隔时间（s）\n  resendVcodeInterval: 60,\n}","/**\n * 开发环境配置\n */\n\nimport { baseConfig }  from './base.config'\nimport { defaultsDeep } from 'lodash'\n\nconst devConf = {\n  // api 配置\n  api: {\n    url: '/'\n  },\n}\n\ndefaultsDeep(devConf, baseConfig)\n\nexport {\n  devConf\n}","/**\n * 生产环境配置\n */\n\nimport { baseConfig } from './base.config'\nimport { defaultsDeep } from 'lodash'\n\nconst prodConf = {\n  api: {\n    url: '' //线上域名\n  },\n}\n\ndefaultsDeep(prodConf, baseConfig)\n\nexport {\n  prodConf\n}","/**\n * 导出配置\n */\nimport {devConf} from './dev.config';\nimport {prodConf} from './prod.config';\n\nlet config: any\nconst env = process.env.NODE_ENV\nif (env === 'development') {\n  config = devConf\n} else {\n  config = prodConf\n}\n\nexport default config","import axios from 'axios'\nimport qs from 'query-string';\nimport config from '@/configs';\nconsole.log(config)\nconst Axios:any = axios.create({\n  baseURL: process.env.REACT_APP_BASE_API,\n  timeout: config.api.timeout,\n  withCredentials: true,\n  headers: {\n    // \"X-Requested-With\": \"XMLHttpRequest\",\n    \"Content-Type\": \"application/x-www-form-urlencoded;charset=utf-8\"\n  },\n  // proxy: \"http://127.0.0.1:8888\"\n})\n\n// Axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded'\n\nAxios.interceptors.request.use( (config: any) => {\n  if (config.method === \"post\") {\n    config.data = qs.stringify(config.data);\n  }\n  // 请求头修改\n  // if (localStorage.token) {\n  //   config.headers.Authorization = localStorage.token;\n  // }\n  return config;\n},  (error: any) => {\n  return Promise.reject(error);\n})\n\nAxios.interceptors.response.use( (response: any) => {\n  \n  return response;\n},  (error: any) => {\n  return Promise.reject(error);\n});\n\n\nconst request = function(method: string, url: string, params: any, config?: object) {\n  return new Promise((resolve, reject) => {\n    Axios[method](url, params, Object.assign({}, config))\n      .then((response: any) => {\n        resolve(response.data)\n      }, (err: any) => {\n        if (err.Cancel) {\n          console.log(err)\n        } else {\n          reject(err)\n        }\n      })\n      .catch((err: any) => {\n        reject(err)\n      })\n  })\n}\n\nclass Http {\n  post: (url: string, params: any) => Promise<any>;\n  get: (url: string, params: any) => Promise<any>;\n  constructor() {\n    this.post = function(url: string, params: any) {\n      return new Promise((resolve, reject) => {\n        request('post', url, params)\n          .then((res: any) => {\n            resolve(res)\n          })\n          .catch((err: any) => {\n            reject(err)\n          })\n      })\n    };\n    this.get = function(url: string, params: any) {\n      return new Promise((resolve, reject) => {\n        request('get', url, {'params': {...params}})\n          .then((res: any) => {\n            resolve(res)\n          })\n          .catch((err: any) => {\n            reject(err)\n          })\n      })\n    };;\n  }\n}\n\nexport default new Http()","import React, { Component } from 'react';\nimport styles from './index.module.less';\nimport { Form, Table, Card, Button, Modal, Input } from 'antd';\nimport http from '@/server';\n\ntype State = {\n  tableData: {\n    value: any[],\n    loading: boolean,\n    pagination: any\n  },\n  modalData: {\n    visible: boolean,\n    value: {\n      age?: number,\n      id?: number,\n      name?: string\n    },\n    type: string\n  }\n}\n\nclass Users extends Component<any, State> {\n\n  state = {\n    tableData: {\n      value: [],\n      loading: false,\n      pagination: false\n    },\n    modalData: {\n      visible: false,\n      value: {\n        id: 1,\n        age: 1,\n        name: ''\n      },\n      type: 'add'\n    }\n  }\n\n  columns = [\n    {\n      title: 'id',\n      dataIndex: 'id',\n      key: 'id',\n    },\n    {\n      title: '姓名',\n      dataIndex: 'name',\n      key: 'name',\n    },\n    {\n      title: '年龄',\n      dataIndex: 'age',\n      key: 'age',\n    },\n    {\n      title: '操作',\n      dataIndex: 'operation',\n      key: 'operation',\n      render: (text: string | undefined, record: {id: number, age: number, name: string}) => (\n        <div className={styles.operation}>\n          <Button className={styles.operationBtn} type=\"primary\" size=\"small\" onClick={() => this.showModal('edit', record)}>编辑</Button>  \n          <Button className={styles.operationBtn} type=\"danger\" size=\"small\" onClick={() => this.deleteUser(record.id)}>删除</Button>\n        </div>\n      )\n    }\n  ]\n\n  fetchUserList=() => {\n    http.get('/users/list',{\n\n    }).then((res: any) => {\n      this.setState({\n        tableData: {\n          loading: false,\n          value: res.data,\n          pagination: false\n        }\n      })\n    }).catch((err: any) => {\n      console.log(err);\n    })\n  }\n\n  deleteUser = (id: number) => {\n    const _this = this\n    Modal.confirm({\n      title: '操作确认',\n      content: '确认删除吗?',\n      onOk: () => {\n        http.post('/users/delete', {\n          id,\n        }).then((res: any) => {\n          _this.fetchUserList()\n        }).catch((err: any) => {\n          console.log(err)\n        })\n      }\n    })\n  }\n\n  showModal = (type: string, record: {id?: number, age?: number, name?: string}) => {\n    this.setState({\n      modalData: {\n        visible: true,\n        value: {\n          ...record\n        },\n        type\n      }\n    })\n    this.props.form.setFieldsValue({\n      name: record.name,\n      age: record.age\n    })\n  }\n\n  hideModal = () => {\n    this.setState({\n      modalData: {\n        visible: false,\n        value: {},\n        type: 'add'\n      }\n    })\n  }\n\n  addUser = (params: {name: string, age: number}) => {\n    http.post('/users/add', params)\n      .then(res => {\n        this.setState({\n          modalData: {\n            ...this.state.modalData,\n            visible: false\n          }\n        })\n        this.fetchUserList()\n      }).catch((err: any) => {\n        console.log(err)\n      })\n  }\n\n  editUser = (params: {id: number, age: number, name: string}) => {\n    http.post('/users/update', params)\n      .then(res => {\n        this.setState({\n          modalData: {\n            ...this.state.modalData,\n            visible: false\n          }\n        })\n        this.fetchUserList()\n      }).catch((err: any) => {\n        console.log(err)\n      })\n  }\n\n  handleModalSubmit = (e:any) => {\n    e.preventDefault();\n    this.props.form.validateFields((err:any, values:{name: string, age: number}) => {\n      if (!err) {\n        const { type, value } = this.state.modalData\n        if(type==='edit') {\n          this.editUser({\n            ...values,\n            id: value.id\n          })\n        }else {\n          this.addUser(values)\n        }\n        \n      }\n    });\n  }\n\n  componentDidMount() {\n    this.fetchUserList()\n  }\n\n  render() {\n    const {\n      tableData,\n      modalData\n    } = this.state\n    const { getFieldDecorator } = this.props.form\n    return(\n      <div className={styles.main}>\n        <Button type=\"primary\" onClick={() => this.showModal('add', {})}>添加用户</Button>\n        <Card\n          title=\"userTable\"\n          bordered\n          size=\"small\"\n        >\n          <Table\n            columns={this.columns}\n            dataSource={tableData.value}\n            loading={tableData.loading}\n            pagination={false}\n            rowKey={(record:{id: number}) => String(record.id)}\n          />\n        </Card>\n        <Modal\n          visible={modalData.visible}\n          title=\"操作\"\n          onOk={this.handleModalSubmit}\n          onCancel={this.hideModal}\n        >\n          <Form>\n            <Form.Item>\n              {getFieldDecorator('name', {\n                rules: [{ required: true, message: 'Please input your username!' }],\n              })(\n                <Input\n                  placeholder=\"Username\"\n                />,\n              )}\n            </Form.Item>\n            <Form.Item>\n              {getFieldDecorator('age', {\n                rules: [{ required: true, message: 'Please input your userage!' }],\n              })(\n                <Input\n                  type=\"number\"\n                  placeholder=\"Userage\"\n                />,\n              )}\n            </Form.Item>\n          </Form>\n        </Modal>\n      </div>\n    )\n  }\n}\nexport default Form.create()(Users)"],"sourceRoot":""}